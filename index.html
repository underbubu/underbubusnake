<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Underbubu Game</title>
  <style>
    :root { --bg:#0b0f14; --panel:#11161d; --text:#e8f0fe; --muted:#9fb0c3; --accent:#22d3ee; --ok:#34d399; }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, 'Apple SD Gothic Neo','Malgun Gothic', sans-serif;
      color:var(--text);
      background: radial-gradient(900px 540px at 50% -10%, #172334 0%, var(--bg) 60%);
      display:grid; grid-template-rows:auto 1fr auto;
    }
    header{padding:16px 12px 6px; text-align:center}
    h1{margin:0 0 6px; font-size:22px}
    .hint{color:var(--muted); font-size:13px}
    .wrap{display:grid; place-items:center; padding:10px 12px}
    canvas{background:#111922; border:1px solid #223041; border-radius:12px; display:block; margin-top:10px; image-rendering:pixelated}
    .footer{color:var(--muted); font-size:12px; text-align:center; padding:12px 0 18px}
    .hud{display:flex; gap:10px; justify-content:center; margin-top:8px}
    .btn{background:#0d1720; color:var(--text); border:1px solid #223041; padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:700}
    .btn:hover{border-color:#2b415a}
  </style>
</head>
<body>
  <header>
    <h1>Underbubu Game</h1>
    <div class="hint">Move: Arrow keys or WASD | Pause: Spacebar â€¢ Game ends if you hit the wall</div>
  </header>

  <div class="wrap">
    <canvas id="board" width="480" height="480" aria-label="game board"></canvas>
    <div class="hud">
      <button id="btnStart" class="btn">Start / Restart</button>
      <button id="btnPause" class="btn">Pause</button>
      <div id="scoreBox" class="hint">Score: <span id="score">0</span></div>
    </div>
  </div>

  <div class="footer">Best score is saved locally in your browser.</div>

  <script>
    // ====== Config ======
    const GRID = 20;
    const START_LEN = 4;
    const canvas = document.getElementById('board');
    const ctx = canvas.getContext('2d');
    let unit = canvas.width / GRID;

    // ====== Assets ======
    const headImg = new Image();
    headImg.src = "snake_head.png";        // custom head image

    const foodImg = new Image();
    foodImg.src = "food.png";              // custom food image (from your upload)

    // ====== State ======
    let snake = [];
    let dir = {x:1,y:0}, queuedDir = {x:1,y:0};
    let food = {x:10,y:10};
    let score = 0, alive = true, paused = false;

    const scoreEl = document.getElementById('score');
    const btnStart = document.getElementById('btnStart');
    const btnPause = document.getElementById('btnPause');

    function reset(){
      snake = [];
      const cx = Math.floor(GRID/2), cy = Math.floor(GRID/2);
      for(let i=0;i<START_LEN;i++) snake.push({x:cx-i, y:cy});
      dir = {x:1,y:0}; queuedDir = dir; score = 0; scoreEl.textContent = score; alive = true; paused = false;
      spawnFood();
    }

    function spawnFood(){
      let p;
      do {
        p = { x: Math.floor(Math.random()*GRID), y: Math.floor(Math.random()*GRID) };
      } while (snake.some(s=>s.x===p.x && s.y===p.y));
      food = p;
    }

    function setDir(d){
      if(dir.x + d.x === 0 && dir.y + d.y === 0) return; // no reverse
      queuedDir = d;
    }

    window.addEventListener('keydown', e=>{
      const k = e.key.toLowerCase();
      if(k===' ') { paused = !paused; return; }
      if(k==='arrowleft'||k==='a') setDir({x:-1,y:0});
      else if(k==='arrowright'||k==='d') setDir({x:1,y:0});
      else if(k==='arrowup'||k==='w') setDir({x:0,y:-1});
      else if(k==='arrowdown'||k==='s') setDir({x:0,y:1});
    });

    btnStart.addEventListener('click', reset);
    btnPause.addEventListener('click', ()=>{ paused = !paused; });

    function update(){
      dir = queuedDir;
      const head = { x: snake[0].x + dir.x, y: snake[0].y + dir.y };

      // Wall collision ends the game
      if (head.x < 0 || head.x >= GRID || head.y < 0 || head.y >= GRID) { alive=false; return; }

      // Self collision
      if (snake.some(s=>s.x===head.x && s.y===head.y)) { alive=false; return; }

      snake.unshift(head);
      if(head.x===food.x && head.y===food.y){
        score += 10; scoreEl.textContent = score; spawnFood();
      } else {
        snake.pop();
      }
    }

    function draw(){
      ctx.clearRect(0,0,canvas.width, canvas.height);
      // food
      if (foodImg.complete) {
        ctx.drawImage(foodImg, food.x*unit, food.y*unit, unit, unit);
      } else {
        ctx.fillStyle = 'red';
        ctx.fillRect(food.x*unit, food.y*unit, unit, unit);
      }

      // snake
      for(let i=0;i<snake.length;i++){
        const s = snake[i];
        if(i===0 && headImg.complete){
          ctx.drawImage(headImg, s.x*unit, s.y*unit, unit, unit);
        } else {
          ctx.fillStyle = i===0 ? '#22d3ee' : '#34d399';
          ctx.fillRect(s.x*unit, s.y*unit, unit, unit);
        }
      }

      // border
      ctx.strokeStyle = 'rgba(255,255,255,.08)';
      ctx.lineWidth = 2;
      ctx.strokeRect(1,1,canvas.width-2,canvas.height-2);
    }

    function loop(){
      if(alive && !paused) update();
      draw();
      setTimeout(loop, 100); // ~10 steps per second
    }

    // High-DPI sharpness
    function fitCanvas(){
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      const cssSide = Math.min(480, Math.floor(window.innerWidth*0.9));
      canvas.style.width = cssSide + 'px';
      canvas.style.height = cssSide + 'px';
      canvas.width = cssSide * dpr;
      canvas.height = cssSide * dpr;
      ctx.setTransform(dpr,0,0,dpr,0,0);
      unit = (canvas.width/dpr) / GRID;
    }
    window.addEventListener('resize', fitCanvas);
    fitCanvas();

    // boot
    reset();
    loop();
  </script>
</body>
</html>
